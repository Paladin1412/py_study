<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.netease.ad.omp.dao.stat.mapper.RevenueAlgorithmMapper">
    <!-- 插入代理商充值返点记录 -->
    <insert id="insertRevenueAlgorithm" parameterType="com.netease.ad.omp.entity.stat.RevenueAlgorithms">
        INSERT INTO ad_revenue_algorithms(sta_month,recharge,rebates,cash_balance,amount_balance)
        VALUES(#{staMonth},#{recharge},#{rebates},#{cashBalance},#{amountBalance})
    </insert>

    <!-- 查询代理商充值记录 -->
    <select id="selectCurrentRecharge" parameterType="com.netease.ad.omp.entity.stat.RevenueAlgorithms" resultType="com.netease.ad.omp.entity.stat.RevenueAlgorithms">
        SELECT sta_month,recharge,rebates,cash_balance AS cashBalance,amount_balance AS amountBalance
        FROM ad_revenue_algorithms
        WHERE sta_month >= #{staMonth} AND agent_id = #{agentId}
    </select>

    <!-- 更新代理商本月充值金额及返点 -->
    <update id="updateAgentRecharge" parameterType="com.netease.ad.omp.entity.stat.RevenueAlgorithms">
        UPDATE ad_revenue_algorithms
        <if test="recharge != null ">
            recharge = #{recharge},
        </if>
        <if test="rebates != null ">
            rebates = #{rebates}
        </if>
        <if test="cashBalance !=null ">
            cash_balance = #{cashBalance},
        </if>
        <if test="amountBalance != null ">
            amount_balance = #{amountBalance}
        </if>
        WHERE agent_id = #{agentId} AND sta_month=#{staMonth}
    </update>


</mapper>